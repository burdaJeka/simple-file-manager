Использование синхронного программного интерфейса
Пример высвобождения Залго учит, что необходимо четко определять характер про­
граммного интерфейса: синхронный или асинхронный.
Один из способов исправления функции inconsistentRead() заключается в том, что­
бы сделать ее полностью синхронной. Это возможно, поскольку платформа Node.js
поддерживает ряд программных интерфейсов для основных операций ввода/выво­
да, соответствующих прямому синхронному стилю. Например, можно использовать
функцию fs.readFileSync() вместо ее асинхронного эквивалента:
const fs = require('fs');
const cache = {};
function consistentReadSync(filename) {
if(cache[filename]) {
return cache[filename];
} else {
cache[filename] = fs.readFileSync(filename, 'utf8');
return cache[filename];
}
}